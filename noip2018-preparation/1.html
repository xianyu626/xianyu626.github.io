<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    <link rel="canonical" href="true/noip2018-preparation/1.html">
    
    
    <title>NOIP2018赛前集训（国庆篇） | 北咸&#39;s Blog | There is an Artificial Idiot...  &lt;/br&gt; 现已兹瓷新域名 southe3n.cf</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="">
    <meta name="description" content="Emmmm…似乎快要NOIP了。。咕咕咕这里整合一下国庆集训（9.29~10.5）的一些NOIP模拟赛凉凉的题  @card{ Matrix时间限制：1s空间限制：256MB  Description 求出满足以下条件的 $n\times m$ 的 $01$ 矩阵个数：  第 $i$ 行第 $1$~$l_i$ 列恰好有 $1$ 个 $1$。 第 $i$ 行第 $r_i$~$m$ 列恰好有 1 个">
<meta property="og:type" content="website">
<meta property="og:title" content="NOIP2018赛前集训（国庆篇）">
<meta property="og:url" content="https://blog.southe3n.cf/noip2018-preparation/1.html">
<meta property="og:site_name" content="北咸&#39;s Blog">
<meta property="og:description" content="Emmmm…似乎快要NOIP了。。咕咕咕这里整合一下国庆集训（9.29~10.5）的一些NOIP模拟赛凉凉的题  @card{ Matrix时间限制：1s空间限制：256MB  Description 求出满足以下条件的 $n\times m$ 的 $01$ 矩阵个数：  第 $i$ 行第 $1$~$l_i$ 列恰好有 $1$ 个 $1$。 第 $i$ 行第 $r_i$~$m$ 列恰好有 1 个">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2018-10-29T12:03:03.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NOIP2018赛前集训（国庆篇）">
<meta name="twitter:description" content="Emmmm…似乎快要NOIP了。。咕咕咕这里整合一下国庆集训（9.29~10.5）的一些NOIP模拟赛凉凉的题  @card{ Matrix时间限制：1s空间限制：256MB  Description 求出满足以下条件的 $n\times m$ 的 $01$ 矩阵个数：  第 $i$ 行第 $1$~$l_i$ 列恰好有 $1$ 个 $1$。 第 $i$ 行第 $r_i$~$m$ 列恰好有 1 个">
    
        <link rel="alternate" type="application/atom+xml" title="北咸&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/ACU.png">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    

</head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">北咸</h5>
          <a href="mailto:qxq22255090@hotmail.com" title="qxq22255090@hotmail.com" class="mail">qxq22255090@hotmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/friends"  >
                <i class="icon icon-lg icon-users"></i>
                友链
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                关于
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">NOIP2018赛前集训（国庆篇）</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header page-header">

    <div class="container fade-scale">
        <h1 class="title">NOIP2018赛前集训（国庆篇）</h1>
        <h5 class="subtitle">
            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    <article class="page-article fade" itemprop="blogPage">
        <div class="post-content page-content" id="page-content" itemprop="pageContent">
            <blockquote>
<p>Emmmm…似乎快要NOIP了。。咕咕咕<br>这里整合一下国庆集训（9.29~10.5）的一些NOIP模拟赛凉凉的题</p>
</blockquote>
<div class="card">
<h2 id="Matrix"><a href="#Matrix" class="headerlink" title="Matrix"></a>Matrix</h2><center><span id="inline-blue">时间限制：1s</span><span id="inline-yellow">空间限制：256MB</span></center>

<p><strong>Description</strong></p>
<p>求出满足以下条件的 $n\times m$ 的 $01$ 矩阵个数：</p>
<ul>
<li>第 $i$ 行第 $1$~$l_i$ 列恰好有 $1$ 个 $1$。</li>
<li>第 $i$ 行第 $r_i$~$m$ 列恰好有 1 个 $1$。</li>
<li>每列至多有 $1$ 个 $1$。</li>
</ul>
<blockquote>
<p>补充题意：在 $l_i$~$r_i$ 列<strong>不能</strong>有$1$</p>
</blockquote>
<p><strong>Input</strong></p>
<p>第一行两个整数 $n,m$。接下来 $n$ 行每行 $2$ 个整数 $l_i,r_i$。</p>
<p><strong>Output</strong></p>
<p>一行一个整数表示答案。对 $998244353$ 取模。</p>
<div class="column-2">
<div class="card">
<p><strong>Sample Input</strong></p>
<pre>
2 6
2 4
5 6
</pre>

</div>
<div class="card">
<p><strong>Sample Output</strong></p>
<pre>12</pre>

</div>
</div>
<p><strong>数据范围</strong></p>
<p>对于 $20\%$的数据，$n,m\le 12$。<br>对于 $40\%$的数据，$n,m\le 50$。<br>对于 $70\%$的数据，$n,m\le 300$。<br>对于 $100\%$的数据，$n,m\le 3000$，$1\le l_i&lt;r_i\le m$。</p>
<p><strong>Solution</strong></p>
<p><strong>用 $f[i][j]$ 表示前 $i$ 列，有 $j$ 行在右侧区间放 $1$ 的方案数</strong>。$i$ 越过一个左侧区间的右端点时，从之前剩下的空列中选一列在这个左侧区间放 $1$</p>
<p>转移时分在右侧区间放 $1$ 或不放 $1$ 两种情况。</p>
<p>时间复杂度 $O(nm)​$</p>
<p><strong>Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,suml[<span class="number">3100</span>],sumr[<span class="number">3100</span>],f[<span class="number">3100</span>][<span class="number">3100</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,x,y;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">        suml[x]++;</span><br><span class="line">        sumr[y]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">        suml[i]+=suml[i<span class="number">-1</span>];</span><br><span class="line">        sumr[i]+=sumr[i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">        f[i][<span class="number">0</span>]=f[i<span class="number">-1</span>][<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=i;j++)</span><br><span class="line">            f[i][j]=(f[i<span class="number">-1</span>][j]+<span class="number">1l</span>l*f[i<span class="number">-1</span>][j<span class="number">-1</span>]*(sumr[i]-j+<span class="number">1</span>))%mod;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=suml[i<span class="number">-1</span>];j&lt;suml[i];j++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=i;k++)</span><br><span class="line">                f[i][k]=<span class="number">1l</span>l*f[i][k]*(i-j-k)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,f[m][n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div>
<div class="card">
<h2 id="星空"><a href="#星空" class="headerlink" title="星空"></a>星空</h2><center><span id="inline-blue">时间限制：1s</span><span id="inline-yellow">空间限制：256MB</span></center>

<p><strong>Description</strong></p>
<p>小C拿来了一长串星型小灯泡，假装是星星，递给小F，想让小F开心一点。不过，有<br>着强迫症的小F发现，这串一共 $𝑛$ 个灯泡的灯泡串上有 $𝑘$ 个灯泡没有被点亮。小F决定<br>和小C一起把这个灯泡串全部点亮。</p>
<p>不过，也许是因为过于笨拙，小F<strong>只能将其中连续一段的灯泡状态给翻转</strong>——点亮暗灯<br>泡，熄灭亮灯泡。经过摸索，小F发现他一共能够翻转 $𝑚$ 种长度的灯泡段中灯泡的状态。</p>
<p>小C和小F最终花了很长很长很长很长很长很长的时间把所有灯泡给全部点亮了。他们想知道他们是不是蠢了，因此他们找到了你，让你帮忙算算：</p>
<p>在最优的情况下，<strong>至少需要几次操</strong>作才能把整个灯泡串给点亮？</p>
<p><strong>Input</strong></p>
<p>输入第 $1$ 行三个正整数 $𝑛, 𝑘, 𝑚$。</p>
<p>输入第 $2$ 行 $𝑘$ 个正整数，第 $𝑖$ 个数表示第 $𝑖$ 个被没点亮的灯泡的位置 $𝑎_𝑖$。</p>
<p>输入第 $3$ 行 $𝑚$ 个正整数，第 $𝑖$ 个数表示第 $𝑖$ 种操作的长度 $𝑏_𝑖$。</p>
<p>保证所有 <script type="math/tex">𝑏_𝑖</script> 互不相同；保证对于 <script type="math/tex">1< 𝑖 < 𝑘</script>，有 <script type="math/tex">𝑎_𝑖 < 𝑎_𝑖+1</script>；保证输入数据有解。</p>
<p><strong>Output</strong></p>
<p>输出一行一个非负整数，表示最少操作次数。</p>
<div class="column-2">
<div class="card">
<p><strong>Sample Input</strong></p>
<pre>
5 2 2
1 5
3 4
</pre>

</div>
<div class="card">
<p><strong>Sample Output</strong></p>
<pre>2</pre>

</div>
</div>
<p><strong>数据范围</strong></p>
<p>保证 $n\le 40000,m\le 64,b_i\le 40000$</p>
<p><strong>Solution</strong></p>
<p>不会，咕咕咕，只贴个膜来的代码…</p>
<p><strong>Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cctype&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">4e4</span>+<span class="number">10</span>,S=<span class="number">1</span>&lt;&lt;<span class="number">16</span>|<span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> n,k,m,t,p[<span class="number">16</span>],b[<span class="number">65</span>],w[N],f[S],cnt[S],s;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;k,&amp;m);</span><br><span class="line">    n++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=k,j=<span class="number">-1</span>,x;i--;j=x)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">        <span class="keyword">if</span>(x==j+<span class="number">1</span>) p[t<span class="number">-1</span>]=x+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                p[t]=x; </span><br><span class="line">                p[t+<span class="number">1</span>]=x+<span class="number">1</span>;</span><br><span class="line">                t+=<span class="number">2</span>; </span><br><span class="line">            &#125;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="built_in">memset</span>(w,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> w);</span><br><span class="line">    w[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;b[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=b[i];j&lt;=n;j++)</span><br><span class="line">            w[j]=min(w[j],w[j-b[i]]+<span class="number">1</span>); </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=n-b[i];j&gt;=<span class="number">0</span>;j--)</span><br><span class="line">            w[j]=min(w[j],w[j+b[i]]+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line">    f[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;(<span class="number">1</span>&lt;&lt;t);i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>((cnt[i]=cnt[i&gt;&gt;<span class="number">1</span>]+(i&amp;<span class="number">1</span>))&amp;<span class="number">1</span>) </span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> j=<span class="number">0</span>,x;</span><br><span class="line">        <span class="keyword">while</span>(((i&gt;&gt;j)&amp;<span class="number">1</span>)==<span class="number">0</span>) j++;</span><br><span class="line">        x=i^(<span class="number">1</span>&lt;&lt;j);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k=j+<span class="number">1</span>;k&lt;t;k++)</span><br><span class="line">            <span class="keyword">if</span>((x&gt;&gt;k)&amp;<span class="number">1</span>)</span><br><span class="line">                f[i]=min(f[i],f[x^(<span class="number">1</span>&lt;&lt;k)]+w[p[k]-p[j]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,f[(<span class="number">1</span>&lt;&lt;t)<span class="number">-1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div>
<div class="card">
<h2 id="玩"><a href="#玩" class="headerlink" title="玩"></a>玩</h2><center><span id="inline-blue">时间限制：1s</span><span id="inline-yellow">空间限制：256MB</span></center>

<p><strong>Description</strong></p>
<p>你有一些<strong>矩形</strong>卡牌，每次你会作如下三个操作：</p>
<ol>
<li>往<strong>当前所有牌后面</strong>放一张牌，这张牌的底边与 $x$ 轴重合且位于第一象限（第一张牌最左边位<br>于 $x=0$ 处）</li>
<li>拿走一张牌，并<strong>把后面的牌向前推</strong>；</li>
<li>询问$[l , r]$这一段牌最高的高度；</li>
</ol>
<p><strong>Input</strong></p>
<p>第一行两个数 $n,c$ 表示操作数、离线操作还是在线；</p>
<p>接下来 $n$ 行每行是如下三种之一</p>
<p>$T=1$，接下来 $len,h$ 分别表示插入的牌的长，高；</p>
<p>$T=2$，接下来 $x$ 表示拿走哪一张牌，牌的编号按<strong>出现顺序</strong>由小到大，从 $1$ 开始（不是操作序号！），<strong>删除的牌不会改变序号</strong>，若序号表示的牌已被删除则不操作；</p>
<p>$T=3$，接下来 $l,$r 表示询问区间；若询问区间上没牌，输出 $0$。</p>
<p>若 $c=1$ ,则上面输入中的 $len,h$ 需要以下式子算出（$lastans$ 为最近一次询问答案）<br>真实输入 = (输入$\times 2333+lastans \times 666)\%100000007+1$;</p>
<p><strong>Output</strong></p>
<p>对每一个询问操作输出该段最高的位置高度是多少。</p>
<div class="column-2">
<div class="card">
<p><strong>Sample Input</strong></p>
<pre>6 0
1 5 3
1 8 2
3 2 6
1 2 4
2 2
3 2 6
</pre>

</div>
<div class="card">
<p><strong>Sample Output</strong></p>
<pre>
3
4
</pre>

</div>
</div>
<p><strong>数据范围</strong></p>
<p>对于 $20\%$的数据，$len=1$；</p>
<p>对于 $40\%$的数据，没有删除操作；</p>
<p>对于额外 $20\%$的数据，$c=0$；</p>
<p>对于 $80\%$的数据，$N\le 2\times 10^5$；</p>
<p>对于 $100\%$的数据，$N\le 5\times 10^5$ ，$len,h\le 10^9$。</p>
<p><strong>Solution</strong></p>
<p>将每一张牌作为<strong>线段树</strong>的一个<strong>叶节点</strong>，线段树维护<strong>区间长度和和最高高度</strong><br>查询时根据位置区间在线段树中<strong>二分</strong>即可</p>
<p><strong>Code</strong></p>
<blockquote>
<p>似乎只有80分？！调了半天找不出错(<del>假装方法对就行</del>)</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt; </span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e8</span>+<span class="number">7</span>,N=<span class="number">5e5</span>+<span class="number">100</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> len[N&lt;&lt;<span class="number">2</span>],ans;</span><br><span class="line"><span class="keyword">int</span> maxh[N&lt;&lt;<span class="number">2</span>],n,c;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    len[u]=len[u&lt;&lt;<span class="number">1</span>]+len[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">    maxh[u]=max(maxh[u&lt;&lt;<span class="number">1</span>],maxh[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> k,<span class="keyword">int</span> Len,<span class="keyword">int</span> H)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        len[u]=Len,maxh[u]=H;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(k&lt;=mid) insert(u&lt;&lt;<span class="number">1</span>,l,mid,k,Len,H);</span><br><span class="line">        <span class="keyword">else</span> insert(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,k,Len,H);</span><br><span class="line">    up(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        len[u]=<span class="number">0</span>,maxh[u]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(k&lt;=mid) del(u&lt;&lt;<span class="number">1</span>,l,mid,k);</span><br><span class="line">        <span class="keyword">else</span> del(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,k);</span><br><span class="line">    up(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=l&amp;&amp;r&lt;=y) <span class="keyword">return</span> maxh[u];</span><br><span class="line">    <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>,res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) res=query(u&lt;&lt;<span class="number">1</span>,l,mid,x,y);</span><br><span class="line">    <span class="keyword">if</span>(y&gt;mid) res=max(res,query(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,x,y));</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getl</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">long</span> <span class="keyword">long</span> size)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(len[u&lt;&lt;<span class="number">1</span>]&lt;=size) <span class="keyword">return</span> getl(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,size-len[u&lt;&lt;<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> getl(u&lt;&lt;<span class="number">1</span>,l,mid,size);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getr</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">long</span> <span class="keyword">long</span> size)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(len[u&lt;&lt;<span class="number">1</span>]&gt;=size) <span class="keyword">return</span> getr(u&lt;&lt;<span class="number">1</span>,l,mid,size);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> getr(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,size-len[u&lt;&lt;<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;c);</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> l,r,h;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,opt,cnt=<span class="number">0</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;opt);</span><br><span class="line">        <span class="keyword">if</span>(opt==<span class="number">1</span>)&#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;l,&amp;h);</span><br><span class="line">            <span class="keyword">if</span>(c)&#123; </span><br><span class="line">                l=(l*<span class="number">2333</span>+ans*<span class="number">666</span>)%mod+<span class="number">1</span>;</span><br><span class="line">                h=(h*<span class="number">2333</span>+ans*<span class="number">666</span>)%mod+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            insert(<span class="number">1</span>,<span class="number">1</span>,n,cnt,l,h);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;h);</span><br><span class="line">            del(<span class="number">1</span>,<span class="number">1</span>,n,h);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;l,&amp;r);</span><br><span class="line">            ans=query(<span class="number">1</span>,<span class="number">1</span>,n,getl(<span class="number">1</span>,<span class="number">1</span>,n,l),getr(<span class="number">1</span>,<span class="number">1</span>,n,r));</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div>
<div class="card">
<h2 id="迷宫"><a href="#迷宫" class="headerlink" title="迷宫"></a>迷宫</h2><center><span id="inline-blue">时间限制：2s</span><span id="inline-yellow">空间限制：512MB</span></center>

<p><strong>Description</strong></p>
<p>迷宫可以抽象成一个<strong>矩阵</strong>，小 $K$ 要从 $(1,1)$ 走到 $(n,m)$ ，而且<strong>只能往下和往右走</strong>，即小 $K$ 只能从 $(x,y)$ 走到$(x,y+1)$ 和 $(x+1,y)$ 。小 $K$ 不能走出迷宫（即 $x&gt;n$ 或 $y&gt;m$ ）。当然，迷宫有一些格子是被堵住的，小 $K$ 不能从这些格子经过。每个没被堵住的格子都有一个权值，小 $K$ 十分喜欢 $X$ 这个数字和<strong>异或</strong>这个运算。<br>所以他希望所有他经过的格子的异或和为 $X$。现在小 $K$ 想知道他有<strong>多少种走法</strong>，听说你是一位大佬，于是他向你求助。</p>
<p><strong>Input</strong></p>
<p>第一行为三个正整数$n,m,X$，表示迷宫有 $n$ 行 $m$ 列，小 $K$ 喜欢 $X$。</p>
<p>接下来的 $n$ 行，每行 $M$ 个正整数，其中第 $i$ 行 $j$ 列的正整数代表 $A<em>{i,j}$ ，若$A</em>{i,j} =0$，则表示第 $𝑖$ 行 $𝑗$ 列被堵住了，若 $A{𝑖,𝑗}&gt;0$ ,这表示第 $𝑖$ 行 $𝑗$ 列没有被堵住，且权值为 $A_{i,j}$ 。</p>
<p>输入保证 $A_{1,1}&gt;0$  且  $A{n,m}&gt;0$。</p>
<p><strong>Output</strong></p>
<p>输出文件包含一行一个正整数，表示小 $K$ 有多少种走法使得他经过的格子的异或和为 $X$。</p>
<div class="column-2">
<div class="card">
<p><strong>Sample Input</strong></p>
<pre>3 3 1
1 1 5
2 3 1
0 4 5
</pre>

</div>
<div class="card">
<p><strong>Sample Output</strong></p>
<pre>2</pre>

</div>
</div>
<p><strong>数据范围</strong></p>
<p><code>Subtask 1</code> $30\%$：$n,m \le 10$</p>
<p><code>Subtask 2</code> $20\%$ : $n,m \le 20$，$0 \le A_{i,j} \le 10000$</p>
<p><code>Subtask 3</code> $50\%​$：$n,m \le 20​$ ,$0 \le 𝐴_{𝑖,𝑗} \le 1,000,000,000​$</p>
<p><strong>Solution</strong></p>
<p>直接从 $(1,1)$ 搜索的话 $O(2^{2n})$显然会TLE，那么考虑折半搜索 <code>meet-in-the-middle</code></p>
<blockquote>
<p>我当时居然不会…咕</p>
</blockquote>
<p>折半搜索的思想是从 $(1,1)$ 到 $(n,m)$ 一定会经过 $(1,m)$-$(n,1)$ 这条<strong>对角线</strong>，所以分别从 $(1,1)$ 和 $(n,m)$ 开始搜索，将到达对角线时的异或和记录进一个 $map$ 中，在对角线时判断路径是否满足条件就好了</p>
<p>这样的复杂度是<strong>$O(2^n·n)$</strong></p>
<p><strong>Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//折半搜索</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> X,a[<span class="number">23</span>][<span class="number">23</span>];</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>,<span class="keyword">long</span> <span class="keyword">long</span>&gt;mp[<span class="number">23</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">long</span> <span class="keyword">long</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;n||y&gt;m) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(a[x][y]==<span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(x+y==(n+m)/<span class="number">2</span>+<span class="number">1</span>)&#123;</span><br><span class="line">        mp[x][k^a[x][y]]++;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs1(x+<span class="number">1</span>,y,k^a[x][y]);</span><br><span class="line">    dfs1(x,y+<span class="number">1</span>,k^a[x][y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">long</span> <span class="keyword">long</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;<span class="number">1</span>||y&lt;<span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(a[x][y]==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(x+y==(n+m)/<span class="number">2</span>+<span class="number">1</span>) <span class="keyword">return</span> mp[x][k];</span><br><span class="line">    <span class="keyword">return</span> dfs2(x<span class="number">-1</span>,y,k^a[x][y])+dfs2(x,y<span class="number">-1</span>,k^a[x][y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%lld"</span>,&amp;n,&amp;m,&amp;X);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;j++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;a[i][j]);</span><br><span class="line">    dfs1(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,dfs2(n,m,X));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div>
<div class="card">
<h2 id="卡片"><a href="#卡片" class="headerlink" title="卡片"></a>卡片</h2><center><span id="inline-blue">时间限制：1s</span><span id="inline-yellow">空间限制：128MB</span></center>

<p><strong>Description</strong></p>
<p>有 $m$ 种卡片，卡片上分别标号为 $1,2,…,m$ ，每种卡片都有<strong>无穷多张</strong>。</p>
<p>现在有 $n$ 个人排成一排，编号分别为 $1,2,…,n$ 。，GISPZJZ 要给每个人发一张卡片。</p>
<p>GISPZJZ 认为 $k$ 是一个不吉利的数字，他希望任意两个相邻的人的卡片点数和不能等于 $k$。现在 GISPZJZ 想知道，他有多少种分发卡片的方式。两种方式被认为是不同的，当且仅当存在一个人，在两种方式中获得的卡片点数不同。</p>
<p><strong>Input</strong></p>
<p>第一行三个正整数 $m,n,k$ ，表示卡片的种数，人数以及不吉利的数字。</p>
<p><strong>Output</strong></p>
<p>一行一个正整数 $x$ ，表示答案。由于答案可能很大，输出答案对 $1000000007$ 取模的结果。 </p>
<div class="column-2">
<div class="card">
<p><strong>Sample Input</strong></p>
<pre>3 3 3</pre>

</div>
<div class="card">
<p><strong>Sample Output</strong></p>
<pre>17</pre>

</div>
</div>
<p><strong>数据范围</strong></p>
<p>对于 $10\%$的数据，$2\le m,n\le 8$。</p>
<p>对于 $30\%$的数据, $2\le m,n\le 400$。</p>
<p>对于 $60\%$的数据，$2\le m,n\le 10^5$。</p>
<p>对于额外 $20\%$的数据，$2\le m\le 10$, $2\le n\le 10^9$。</p>
<p>对于 100%的数据，$2\le m,n\le 10^9$ ，$2\le k\le 2m$。 </p>
<p><strong>Solution</strong></p>
<blockquote>
<p>写出来的代码不知道为什么WA掉了…方法是对的，权当口胡吧</p>
</blockquote>
<p>首先可以得出一个比较显然的DP：</p>
<p>$f[i][j]$ 表示发牌到第 $i$ 个人，且第 $i-1$ 个人的牌为 $j$ ,这样就是一个 $O(nm)$ 的DP</p>
<p>再考虑一下，发现其实牌只需要分两种，一种是可能与上一张牌加和等于 $k$ 的，一种是加和不可能等于 $k$ 的，即小于 $k$ 和大于等于 $k$ 两类，这两类的所有牌其实本质是一样的，并在一起转移就可以了，这样就是 $O(n)$ 的DP</p>
<p>最后发现似乎可以用<strong>矩阵乘法</strong>优化一下？恭喜你找到了<strong>$O(\log n)$</strong>的做法</p>
</div>
<div class="card">
<h2 id="车站"><a href="#车站" class="headerlink" title="车站"></a>车站</h2><center><span id="inline-blue">时间限制：3s</span><span id="inline-yellow">空间限制：256MB</span></center>

<p><strong>Description</strong></p>
<p>在一条公路上，有 $n$ 个村庄，编号分别为 $1,2,3,…,n$ 。每两个相邻的村庄之间的距离都是 $1km$。在第 $i$ 个村庄里住着 $a_i$ 个人。现在接连发生了 $q$ 个事件，第 $i$ 个事件可以表示为$(p_i,b_i)$，即第 $p_i$ 个村庄增加了 $b_i$ 个人（$b_i$ 可能是负的，表示第 $p_i$ 个村庄减少了 $b_i$ 个人。）</p>
<p>$zyb$ 现在想建一个车站，使得所有村庄的所有人到车站的距离和最短。$zyb$ 希望车站就建立在某个村庄，<strong>如果存在多个村庄满足所有人到车站的距离和最短，$zyb$ 希望选择编号最小的村庄建立车站。</strong></p>
<p>现在 $zyb$ 想知道，在每个事件发生后，车站应该建立在哪个村庄。</p>
<p>由于测试规模较大，设第 $i$ 次事件发生后，车站应该建立在第 $x<em>i$ 个村庄，你只需要输出 $\Sigma</em>{i=1}^q 19260817^i·x_i$ 对 $998244353$ 取模后的答案</p>
<p><strong>Input</strong></p>
<p>第一行两个正整数 $n,q$ 。</p>
<p>第二行 $n$ 个正整数 $a_1,a_2,…,a_n$ 。</p>
<p>接下来 $q$ 行，第 $i$ 行两个正整数 $(p_i,b_i)$ ，表示第 $i$ 个事件：第 $p_i$ 个村庄增加了 $b_i$ 人。</p>
<p>输入数据保证，任何时刻，每个村庄的人数都大于 $0$。 </p>
<p><strong>Output</strong></p>
<p>总共 $q$ 行，第 $i$ 行一个正整数，表示第 $i$ 个事件发生后 $zyb$ 建立车站的位置。 </p>
<div class="column-2">
<div class="card">
<p><strong>Sample Input</strong></p>
<pre>3 3
4 2 2
1 -2
3 2
3 1 
</pre>

</div>
<div class="card">
<p><strong>Sample Output</strong></p>
<pre>186493280</pre>


</div>
</div>
<p><strong>数据范围</strong></p>
<p>对于 $20\%$ 的数据，$1\le n\le 1000,1\le q\le 1000$ 。</p>
<p>对于 $60\%$ 的数据，$1\le n\le 200000,1\le q\le 80000$ 。</p>
<p>对于 $100\%$ 的数据，$1\le n\le 200000,1\le q\le 1000000,1\le a_i,b_i\le 1000000000$。 </p>
<p><strong>Solution</strong></p>
<p>首先想如果点（即村庄）<strong>不带权</strong>怎么做</p>
<p>结论是车站建在最中间的那个村庄最优（点数为偶数则是中间两点中间任意一点）</p>
<blockquote>
<p><strong>证明</strong>：设最中间一点坐标为 $x$ ，共 $2n+1$ 个点</p>
<p>若 $x$ 增大 $k$ ，则会有大于 $n$ 个点的距离加 $k$ ，小于等于 $n$  个点距离减 $k$ ,显然更劣</p>
<p>$x$ 减小的情况同理。</p>
</blockquote>
<p>那么带权时把一个点想成权值个点就可以用这个结论做了。要做的就是找出<strong>权值和的一半在哪个村庄</strong></p>
<p>写个区间线段树，在线段树上进行二分。（当然树状数组也可以，但本蒟蒻不会…）</p>
<p>时间复杂度 <strong>$O(q \log{n})$</strong></p>
<p><strong>Code</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cctype&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;<span class="keyword">int</span> ch=getchar(),f=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch)) &#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>) f=<span class="number">-1</span>; ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch<span class="number">-48</span>,ch=getchar();</span><br><span class="line">    x*=f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> base=<span class="number">19260817</span>,mod=<span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,q,a[<span class="number">201000</span>];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> sum[<span class="number">801000</span>],nowbase=base,ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        sum[u]=a[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(u&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">    build(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">    sum[u]=sum[u&lt;&lt;<span class="number">1</span>]+sum[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x,<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        sum[u]+=w;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) update(u&lt;&lt;<span class="number">1</span>,l,mid,x,w);</span><br><span class="line">        <span class="keyword">else</span> update(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,x,w);</span><br><span class="line">    sum[u]=sum[u&lt;&lt;<span class="number">1</span>]+sum[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">long</span> <span class="keyword">long</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(k&lt;=sum[u&lt;&lt;<span class="number">1</span>]) <span class="keyword">return</span> query(u&lt;&lt;<span class="number">1</span>,l,mid,k);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> query(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,k-sum[u&lt;&lt;<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span>&#123;</span><br><span class="line">    freopen(<span class="string">"station.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"station.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</span><br><span class="line">    read(n); read(q);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) read(a[i]);</span><br><span class="line">    build(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">    <span class="keyword">int</span> x,y;</span><br><span class="line">    <span class="keyword">while</span>(q--)&#123;</span><br><span class="line">        read(x),read(y);</span><br><span class="line">        update(<span class="number">1</span>,<span class="number">1</span>,n,x,y);</span><br><span class="line">        (ans+=nowbase*query(<span class="number">1</span>,<span class="number">1</span>,n,(sum[<span class="number">1</span>]+<span class="number">1</span>)/<span class="number">2</span>))%=mod;</span><br><span class="line">        nowbase=nowbase*base%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div>

        </div>

        

        


        











    <!-- Valine Comments -->
    <div class="comments vcomment" id="comments"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            el: '#comments',
            notify: 'true' == 'true',
            verify: 'false' == 'true',
            appId: "1Ya3GFYLfUGzgL7S113cABvD-gzGzoHsz",
            appKey: "UiTLEJsU3isv39WUo2JGxqtz",
            avatar: "mm",
            placeholder: "Just go go",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->







    </article>
    

</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>北咸 &copy; 2018 - 2019</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://blog.southe3n.cf/noip2018-preparation/1.html&title=《NOIP2018赛前集训（国庆篇）》 — 北咸's Blog&pic=https://blog.southe3n.cf/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://blog.southe3n.cf/noip2018-preparation/1.html&title=《NOIP2018赛前集训（国庆篇）》 — 北咸's Blog&source=found on 2018-4-30" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.southe3n.cf/noip2018-preparation/1.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《NOIP2018赛前集训（国庆篇）》 — 北咸's Blog&url=https://blog.southe3n.cf/noip2018-preparation/1.html&via=https://blog.southe3n.cf" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://blog.southe3n.cf/noip2018-preparation/1.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACMUlEQVR42u3aQY7jMAwEwPn/p2cve1hgELtbTGZhqXwKEkdW5cCQIr++4uv7x/Xz/Vf3X6+Wf+sNFwYGxmMZ35fXNePfT1+tfP2UV3fme8PAwDiHkWzi+v72zutN53vDwMDAyB+WJ4J5+MbAwMCYB9w84UtC6n/738DAwHgIY15kJg/Orw/W4hgYGA9k5Kfuv//6I/0NDAyMRzHWgmCyQhuO1/bzdzUMDIytGe3xfT5m0TYAkhVuxjIwMDAOYLSHbu0hWjsc1r6DgYGxKyM/wEqajm1Lsj1WexmyMTAwtmZMRrWSQjdvba6ljxgYGCcwJoVlDpv8BHUVjoGBcQDjE/F7XqzeBGsMDIzDGJN5jbZtMG8V1KkhBgbGYxntIEU+hJGf2ych+6aIxcDAOIyRJGTzgbB26/WYBQYGxnaMNrCuDVi8a/xi8Z8BAwPjsYw2gK4dveVtzrwAvqnFMTAwNmLkw1jzgLvWQriJtBgYGFsz8kZmnlxORjHWAjQGBgbGZPAiH8VIVhhNjmBgYGzKSJqI7QptgZp/CwMD4xzG5PFtoZunmElbAgMD4zRGe3yfJ3DtoV6SSmJgYOzNmA9b1L9ZWTxHVAwMjK0Z+bV2EDYZ2miPAjEwMPZmtEleUlK2A2d52YyBgXEyY566JZtu08fi+A8DAwNjMDqWtwTWmgoYGBgYa3XwpHxt2xIYGBjnMJJSs00Q2yK2TSsxMDDOYayNOCSPn4fsNzc1MTAwnsf4A8fKYL4zibm6AAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>



<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" async></script>




<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '(っ·Д·)っ页面崩溃了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->



</body>
</html>
